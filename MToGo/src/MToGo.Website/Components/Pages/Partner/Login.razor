@page "/partner/login"
@using MToGo.Website.Components.Shared
@inject NavigationManager Navigation
@inject AuthService Auth
@inject CultureService CultureService
@inject ILocalizerService L
@implements IDisposable
@rendermode InteractiveServer

<PageTitle>@L["Pages.Partner.Login.PageTitle"]</PageTitle>

<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-md-6">
            <LoginForm 
                IdentifierLabel="@L["Pages.Partner.Login.Email"]"
                IdentifierPlaceholder="@L["Pages.Partner.Login.EmailPlaceholder"]"
                PasswordLabel="@L["Pages.Partner.Login.Password"]"
                PasswordPlaceholder="@L["Pages.Partner.Login.PasswordPlaceholder"]"
                ApiEndpoint="/api/v1/partners/login"
                RedirectUrl="/partner/{id}/incoming-orders"
                CardTitle="@L["Pages.Partner.Login.Title"]"
                CardHeaderClass=""
                ButtonClass="btn-primary"
                ButtonText="@L["Pages.Partner.Login.LoginButton"]"
                LoadingText="@L["Pages.Partner.Login.LoggingIn"]"
                RedirectDelayMs="1000"
                FormName="PartnerLoginForm">
                <AdditionalLinks>
                    <div class="d-grid">
                        <div class="mt-3 text-center">
                            <p class="mb-0">@L["Pages.Partner.Login.NoAccount"] <a href="/partner/register">@L["Pages.Partner.Login.RegisterHere"]</a></p>
                        </div>

                        <hr class="my-3" />

                        <div class="text-center">
                            <p class="mb-1">@L["Pages.Partner.Login.CustomerQuestion"]</p>
                            <a href="/login">@L["Pages.Partner.Login.CustomerLogin"]</a>
                        </div>
                    </div>
                </AdditionalLinks>
            </LoginForm>
        </div>
    </div>
</div>

@code {
    protected override void OnInitialized()
    {
        CultureService.OnChange += OnCultureChanged;
    }

    private void OnCultureChanged()
    {
        InvokeAsync(StateHasChanged);
    }

    public void Dispose()
    {
        CultureService.OnChange -= OnCultureChanged;
    }
}
